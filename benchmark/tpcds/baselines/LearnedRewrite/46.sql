SELECT "customer3380"."c_last_name", "customer3380"."c_first_name", "customer_address2083"."ca_city", "t59249"."bought_city", "t59249"."ss_ticket_number", "t59249"."amt", "t59249"."profit" FROM (SELECT "t59245"."ss_ticket_number", "t59245"."ss_customer_sk", "t59246"."ca_city" AS "bought_city", "t59245"."amt" * "t59246"."f2" AS "amt", "t59245"."profit" * "t59246"."f2" AS "profit" FROM (SELECT "t59241"."ss_customer_sk", "t59241"."ss_addr_sk", "t59241"."ss_ticket_number", SUM("t59241"."amt" * "t59243"."f1") AS "amt", SUM("t59241"."profit" * "t59243"."f1") AS "profit" FROM (SELECT "t59237"."ss_customer_sk", "t59237"."ss_hdemo_sk", "t59237"."ss_addr_sk", "t59237"."ss_ticket_number", SUM("t59237"."amt" * "t59239"."f1") AS "amt", SUM("t59237"."profit" * "t59239"."f1") AS "profit" FROM (SELECT "t59233"."ss_customer_sk", "t59233"."ss_hdemo_sk", "t59233"."ss_addr_sk", "t59233"."ss_store_sk", "t59233"."ss_ticket_number", SUM("t59233"."amt" * "t59235"."f1") AS "amt", SUM("t59233"."profit" * "t59235"."f1") AS "profit" FROM (SELECT "ss_sold_date_sk", "ss_customer_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_store_sk", "ss_ticket_number", SUM("ss_coupon_amt") AS "amt", SUM("ss_net_profit") AS "profit" FROM "store_sales" GROUP BY "ss_sold_date_sk", "ss_customer_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_store_sk", "ss_ticket_number") AS "t59233" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_dow" IN (0, 6) AND ("d_year" = 2000 OR "d_year" = 2000 + 1 OR "d_year" = 2000 + 2) GROUP BY "d_date_sk") AS "t59235" ON "t59233"."ss_sold_date_sk" = "t59235"."d_date_sk" GROUP BY "t59233"."ss_customer_sk", "t59233"."ss_hdemo_sk", "t59233"."ss_addr_sk", "t59233"."ss_store_sk", "t59233"."ss_ticket_number") AS "t59237" INNER JOIN (SELECT "s_store_sk", COUNT(*) AS "f1" FROM "store" WHERE "s_city" IN ('Fairview', 'Midway') GROUP BY "s_store_sk") AS "t59239" ON "t59237"."ss_store_sk" = "t59239"."s_store_sk" GROUP BY "t59237"."ss_customer_sk", "t59237"."ss_hdemo_sk", "t59237"."ss_addr_sk", "t59237"."ss_ticket_number") AS "t59241" INNER JOIN (SELECT "hd_demo_sk", COUNT(*) AS "f1" FROM "household_demographics" WHERE "hd_dep_count" = 8 OR "hd_vehicle_count" = 0 GROUP BY "hd_demo_sk") AS "t59243" ON "t59241"."ss_hdemo_sk" = "t59243"."hd_demo_sk" GROUP BY "t59241"."ss_customer_sk", "t59241"."ss_addr_sk", "t59241"."ss_ticket_number") AS "t59245" INNER JOIN (SELECT "ca_address_sk", "ca_city", COUNT(*) AS "f2" FROM "customer_address" GROUP BY "ca_address_sk", "ca_city") AS "t59246" ON "t59245"."ss_addr_sk" = "t59246"."ca_address_sk") AS "t59249" INNER JOIN "customer" AS "customer3380" ON "t59249"."ss_customer_sk" = "customer3380"."c_customer_sk" INNER JOIN "customer_address" AS "customer_address2083" ON "customer3380"."c_current_addr_sk" = "customer_address2083"."ca_address_sk" AND "customer_address2083"."ca_city" <> "t59249"."bought_city" ORDER BY "customer3380"."c_last_name", "customer3380"."c_first_name", "customer_address2083"."ca_city", "t59249"."bought_city", "t59249"."ss_ticket_number" FETCH NEXT 100 ROWS ONLY