SELECT "item1257"."i_item_id", "t31082"."s_state", GROUPING("t31082"."s_state") AS "g_state", AVG("store_sales3193"."ss_quantity") AS "agg1", AVG("store_sales3193"."ss_list_price") AS "agg2", AVG("store_sales3193"."ss_coupon_amt") AS "agg3", AVG("store_sales3193"."ss_sales_price") AS "agg4" FROM "store_sales" AS "store_sales3193" INNER JOIN (SELECT * FROM "customer_demographics" WHERE "cd_gender" = 'M' AND "cd_marital_status" = 'W' AND "cd_education_status" = 'Secondary           ') AS "t31080" ON "store_sales3193"."ss_cdemo_sk" = "t31080"."cd_demo_sk" INNER JOIN (SELECT * FROM "date_dim" WHERE "d_year" = 1999) AS "t31081" ON "store_sales3193"."ss_sold_date_sk" = "t31081"."d_date_sk" INNER JOIN (SELECT * FROM "store" WHERE "s_state" = 'TN') AS "t31082" ON "store_sales3193"."ss_store_sk" = "t31082"."s_store_sk" INNER JOIN "item" AS "item1257" ON "store_sales3193"."ss_item_sk" = "item1257"."i_item_sk" GROUP BY ROLLUP("t31082"."s_state", "item1257"."i_item_id") ORDER BY "item1257"."i_item_id", "t31082"."s_state" FETCH NEXT 100 ROWS ONLY