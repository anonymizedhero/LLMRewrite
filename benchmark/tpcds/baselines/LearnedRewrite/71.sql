SELECT "t106737"."i_brand_id" AS "brand_id", "t106737"."i_brand" AS "brand", "t106739"."t_hour", "t106739"."t_minute", SUM("t106737"."ext_price" * "t106739"."f3") AS "ext_price" FROM (SELECT "t106713"."i_brand_id", "t106713"."i_brand", "t106735"."ws_sold_time_sk" AS "time_sk", SUM("t106713"."f3" * "t106735"."ext_price") AS "ext_price" FROM (SELECT "i_item_sk", "i_brand_id", "i_brand", COUNT(*) AS "f3" FROM "item" WHERE "i_manager_id" = 1 GROUP BY "i_item_sk", "i_brand_id", "i_brand") AS "t106713" INNER JOIN (SELECT "ws_item_sk", "ws_sold_time_sk", SUM("ext_price") AS "ext_price" FROM (SELECT "ws_item_sk", "ws_sold_time_sk", SUM("ext_price") AS "ext_price" FROM (SELECT "t106714"."ws_item_sk", "t106714"."ws_sold_time_sk", SUM("t106714"."ext_price" * "t106716"."f1") AS "ext_price" FROM (SELECT "ws_sold_date_sk", "ws_sold_time_sk", "ws_item_sk", SUM("ws_ext_sales_price") AS "ext_price" FROM "web_sales" GROUP BY "ws_sold_date_sk", "ws_sold_time_sk", "ws_item_sk") AS "t106714" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_moy" = 12 AND "d_year" = 2002 GROUP BY "d_date_sk") AS "t106716" ON "t106714"."ws_sold_date_sk" = "t106716"."d_date_sk" GROUP BY "t106714"."ws_sold_time_sk", "t106714"."ws_item_sk" UNION ALL SELECT "t106720"."cs_item_sk", "t106720"."cs_sold_time_sk", SUM("t106720"."ext_price" * "t106722"."f1") AS "ext_price" FROM (SELECT "cs_sold_date_sk", "cs_sold_time_sk", "cs_item_sk", SUM("cs_ext_sales_price") AS "ext_price" FROM "catalog_sales" GROUP BY "cs_sold_date_sk", "cs_sold_time_sk", "cs_item_sk") AS "t106720" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_moy" = 12 AND "d_year" = 2002 GROUP BY "d_date_sk") AS "t106722" ON "t106720"."cs_sold_date_sk" = "t106722"."d_date_sk" GROUP BY "t106720"."cs_sold_time_sk", "t106720"."cs_item_sk") AS "t106726" GROUP BY "ws_item_sk", "ws_sold_time_sk" UNION ALL SELECT "t106728"."ss_item_sk", "t106728"."ss_sold_time_sk", SUM("t106728"."ext_price" * "t106730"."f1") AS "ext_price" FROM (SELECT "ss_sold_date_sk", "ss_sold_time_sk", "ss_item_sk", SUM("ss_ext_sales_price") AS "ext_price" FROM "store_sales" GROUP BY "ss_sold_date_sk", "ss_sold_time_sk", "ss_item_sk") AS "t106728" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_moy" = 12 AND "d_year" = 2002 GROUP BY "d_date_sk") AS "t106730" ON "t106728"."ss_sold_date_sk" = "t106730"."d_date_sk" GROUP BY "t106728"."ss_sold_time_sk", "t106728"."ss_item_sk") AS "t106734" GROUP BY "ws_item_sk", "ws_sold_time_sk") AS "t106735" ON "t106713"."i_item_sk" = "t106735"."ws_item_sk" GROUP BY "t106713"."i_brand_id", "t106713"."i_brand", "t106735"."ws_sold_time_sk") AS "t106737" INNER JOIN (SELECT "t_time_sk", "t_hour", "t_minute", COUNT(*) AS "f3" FROM "time_dim" WHERE "t_meal_time" IN ('breakfast', 'dinner') GROUP BY "t_time_sk", "t_hour", "t_minute") AS "t106739" ON "t106737"."time_sk" = "t106739"."t_time_sk" GROUP BY "t106737"."i_brand_id", "t106737"."i_brand", "t106739"."t_hour", "t106739"."t_minute" ORDER BY SUM("t106737"."ext_price" * "t106739"."f3") DESC, "t106737"."i_brand_id"