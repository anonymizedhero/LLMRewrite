SELECT "i_manufact_id", SUM("total_sales") AS "total_sales" FROM (SELECT "i_manufact_id", SUM("total_sales") AS "total_sales" FROM (SELECT "t45416"."i_manufact_id", "t45416"."total_sales" FROM (SELECT "t45414"."i_manufact_id", SUM("t45413"."total_sales" * "t45414"."f2") AS "total_sales" FROM (SELECT "t45409"."ss_item_sk", SUM("t45409"."total_sales" * "t45411"."f1") AS "total_sales" FROM (SELECT "t45405"."ss_item_sk", "t45405"."ss_addr_sk", SUM("t45405"."total_sales" * "t45407"."f1") AS "total_sales" FROM (SELECT "ss_sold_date_sk", "ss_item_sk", "ss_addr_sk", SUM("ss_ext_sales_price") AS "total_sales" FROM "store_sales" GROUP BY "ss_sold_date_sk", "ss_item_sk", "ss_addr_sk") AS "t45405" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_year" = 2001 AND "d_moy" = 3 GROUP BY "d_date_sk") AS "t45407" ON "t45405"."ss_sold_date_sk" = "t45407"."d_date_sk" GROUP BY "t45405"."ss_item_sk", "t45405"."ss_addr_sk") AS "t45409" INNER JOIN (SELECT "ca_address_sk", COUNT(*) AS "f1" FROM "customer_address" WHERE "ca_gmt_offset" = -5 GROUP BY "ca_address_sk") AS "t45411" ON "t45409"."ss_addr_sk" = "t45411"."ca_address_sk" GROUP BY "t45409"."ss_item_sk") AS "t45413" INNER JOIN (SELECT "i_item_sk", "i_manufact_id", COUNT(*) AS "f2" FROM "item" GROUP BY "i_item_sk", "i_manufact_id") AS "t45414" ON "t45413"."ss_item_sk" = "t45414"."i_item_sk" GROUP BY "t45414"."i_manufact_id") AS "t45416" INNER JOIN (SELECT "i_manufact_id" FROM "item" WHERE "i_category" = 'Books' GROUP BY "i_manufact_id") AS "t45418" ON "t45416"."i_manufact_id" = "t45418"."i_manufact_id" UNION ALL SELECT "t45432"."i_manufact_id", "t45432"."total_sales" FROM (SELECT "t45430"."i_manufact_id", SUM("t45429"."total_sales" * "t45430"."f2") AS "total_sales" FROM (SELECT "t45425"."cs_item_sk", SUM("t45425"."total_sales" * "t45427"."f1") AS "total_sales" FROM (SELECT "t45421"."cs_bill_addr_sk", "t45421"."cs_item_sk", SUM("t45421"."total_sales" * "t45423"."f1") AS "total_sales" FROM (SELECT "cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", SUM("cs_ext_sales_price") AS "total_sales" FROM "catalog_sales" GROUP BY "cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk") AS "t45421" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_year" = 2001 AND "d_moy" = 3 GROUP BY "d_date_sk") AS "t45423" ON "t45421"."cs_sold_date_sk" = "t45423"."d_date_sk" GROUP BY "t45421"."cs_bill_addr_sk", "t45421"."cs_item_sk") AS "t45425" INNER JOIN (SELECT "ca_address_sk", COUNT(*) AS "f1" FROM "customer_address" WHERE "ca_gmt_offset" = -5 GROUP BY "ca_address_sk") AS "t45427" ON "t45425"."cs_bill_addr_sk" = "t45427"."ca_address_sk" GROUP BY "t45425"."cs_item_sk") AS "t45429" INNER JOIN (SELECT "i_item_sk", "i_manufact_id", COUNT(*) AS "f2" FROM "item" GROUP BY "i_item_sk", "i_manufact_id") AS "t45430" ON "t45429"."cs_item_sk" = "t45430"."i_item_sk" GROUP BY "t45430"."i_manufact_id") AS "t45432" INNER JOIN (SELECT "i_manufact_id" FROM "item" WHERE "i_category" = 'Books' GROUP BY "i_manufact_id") AS "t45434" ON "t45432"."i_manufact_id" = "t45434"."i_manufact_id") AS "t45437" GROUP BY "i_manufact_id" UNION ALL SELECT "t45450"."i_manufact_id", SUM("t45450"."total_sales") AS "total_sales" FROM (SELECT "t45448"."i_manufact_id", SUM("t45447"."total_sales" * "t45448"."f2") AS "total_sales" FROM (SELECT "t45443"."ws_item_sk", SUM("t45443"."total_sales" * "t45445"."f1") AS "total_sales" FROM (SELECT "t45439"."ws_item_sk", "t45439"."ws_bill_addr_sk", SUM("t45439"."total_sales" * "t45441"."f1") AS "total_sales" FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk", SUM("ws_ext_sales_price") AS "total_sales" FROM "web_sales" GROUP BY "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk") AS "t45439" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_year" = 2001 AND "d_moy" = 3 GROUP BY "d_date_sk") AS "t45441" ON "t45439"."ws_sold_date_sk" = "t45441"."d_date_sk" GROUP BY "t45439"."ws_item_sk", "t45439"."ws_bill_addr_sk") AS "t45443" INNER JOIN (SELECT "ca_address_sk", COUNT(*) AS "f1" FROM "customer_address" WHERE "ca_gmt_offset" = -5 GROUP BY "ca_address_sk") AS "t45445" ON "t45443"."ws_bill_addr_sk" = "t45445"."ca_address_sk" GROUP BY "t45443"."ws_item_sk") AS "t45447" INNER JOIN (SELECT "i_item_sk", "i_manufact_id", COUNT(*) AS "f2" FROM "item" GROUP BY "i_item_sk", "i_manufact_id") AS "t45448" ON "t45447"."ws_item_sk" = "t45448"."i_item_sk" GROUP BY "t45448"."i_manufact_id") AS "t45450" INNER JOIN (SELECT "i_manufact_id" FROM "item" WHERE "i_category" = 'Books' GROUP BY "i_manufact_id") AS "t45452" ON "t45450"."i_manufact_id" = "t45452"."i_manufact_id" GROUP BY "t45450"."i_manufact_id") AS "t45454" GROUP BY "i_manufact_id" ORDER BY SUM("total_sales") FETCH NEXT 100 ROWS ONLY