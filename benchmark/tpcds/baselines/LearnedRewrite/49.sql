SELECT "channel", "item", "return_ratio", "return_rank", "currency_rank" FROM (SELECT * FROM (SELECT 'web' AS "channel", "item", "return_ratio", "return_rank", "currency_rank" FROM (SELECT "t64107"."item", CAST("t64107"."f1" AS DECIMAL(15, 4)) / CAST("t64107"."f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("t64107"."f3" AS DECIMAL(15, 4)) / CAST("t64107"."f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("t64107"."f1" AS DECIMAL(15, 4)) / CAST("t64107"."f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("t64107"."f3" AS DECIMAL(15, 4)) / CAST("t64107"."f4" AS DECIMAL(15, 4))) AS "currency_rank" FROM (SELECT "t64104"."ws_item_sk" AS "item", SUM(CASE WHEN "t64104"."wr_return_quantity" IS NOT NULL THEN CAST("t64104"."wr_return_quantity" AS INTEGER) ELSE 0 END) AS "f1", SUM("t64104"."ws_quantity") AS "f2", SUM(CASE WHEN "t64104"."wr_return_amt" IS NOT NULL THEN CAST("t64104"."wr_return_amt" AS DECIMAL(19, 0)) ELSE 0 END) AS "f3", SUM("t64104"."ws_net_paid") AS "f4" FROM (SELECT "t64102"."ws_sold_date_sk", "t64102"."ws_sold_time_sk", "t64102"."ws_ship_date_sk", "t64102"."ws_item_sk", "t64102"."ws_bill_customer_sk", "t64102"."ws_bill_cdemo_sk", "t64102"."ws_bill_hdemo_sk", "t64102"."ws_bill_addr_sk", "t64102"."ws_ship_customer_sk", "t64102"."ws_ship_cdemo_sk", "t64102"."ws_ship_hdemo_sk", "t64102"."ws_ship_addr_sk", "t64102"."ws_web_page_sk", "t64102"."ws_web_site_sk", "t64102"."ws_ship_mode_sk", "t64102"."ws_warehouse_sk", "t64102"."ws_promo_sk", "t64102"."ws_order_number", "t64102"."ws_quantity", "t64102"."ws_wholesale_cost", "t64102"."ws_list_price", "t64102"."ws_sales_price", "t64102"."ws_ext_discount_amt", "t64102"."ws_ext_sales_price", "t64102"."ws_ext_wholesale_cost", "t64102"."ws_ext_list_price", "t64102"."ws_ext_tax", "t64102"."ws_coupon_amt", "t64102"."ws_ext_ship_cost", "t64102"."ws_net_paid", "t64102"."ws_net_paid_inc_tax", "t64102"."ws_net_paid_inc_ship", "t64102"."ws_net_paid_inc_ship_tax", "t64102"."ws_net_profit", CAST("t64103"."wr_returned_date_sk" AS INTEGER) AS "wr_returned_date_sk", CAST("t64103"."wr_returned_time_sk" AS INTEGER) AS "wr_returned_time_sk", CAST("t64103"."wr_item_sk" AS INTEGER) AS "wr_item_sk", CAST("t64103"."wr_refunded_customer_sk" AS INTEGER) AS "wr_refunded_customer_sk", CAST("t64103"."wr_refunded_cdemo_sk" AS INTEGER) AS "wr_refunded_cdemo_sk", CAST("t64103"."wr_refunded_hdemo_sk" AS INTEGER) AS "wr_refunded_hdemo_sk", CAST("t64103"."wr_refunded_addr_sk" AS INTEGER) AS "wr_refunded_addr_sk", CAST("t64103"."wr_returning_customer_sk" AS INTEGER) AS "wr_returning_customer_sk", CAST("t64103"."wr_returning_cdemo_sk" AS INTEGER) AS "wr_returning_cdemo_sk", CAST("t64103"."wr_returning_hdemo_sk" AS INTEGER) AS "wr_returning_hdemo_sk", CAST("t64103"."wr_returning_addr_sk" AS INTEGER) AS "wr_returning_addr_sk", CAST("t64103"."wr_web_page_sk" AS INTEGER) AS "wr_web_page_sk", CAST("t64103"."wr_reason_sk" AS INTEGER) AS "wr_reason_sk", CAST("t64103"."wr_order_number" AS INTEGER) AS "wr_order_number", CAST("t64103"."wr_return_quantity" AS INTEGER) AS "wr_return_quantity", CAST("t64103"."wr_return_amt" AS DECIMAL(19, 0)) AS "wr_return_amt", CAST("t64103"."wr_return_tax" AS DECIMAL(19, 0)) AS "wr_return_tax", CAST("t64103"."wr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "wr_return_amt_inc_tax", CAST("t64103"."wr_fee" AS DECIMAL(19, 0)) AS "wr_fee", CAST("t64103"."wr_return_ship_cost" AS DECIMAL(19, 0)) AS "wr_return_ship_cost", CAST("t64103"."wr_refunded_cash" AS DECIMAL(19, 0)) AS "wr_refunded_cash", CAST("t64103"."wr_reversed_charge" AS DECIMAL(19, 0)) AS "wr_reversed_charge", CAST("t64103"."wr_account_credit" AS DECIMAL(19, 0)) AS "wr_account_credit", CAST("t64103"."wr_net_loss" AS DECIMAL(19, 0)) AS "wr_net_loss" FROM (SELECT * FROM "web_sales" WHERE "ws_net_profit" > 1 AND "ws_net_paid" > 0 AND "ws_quantity" > 0) AS "t64102" INNER JOIN (SELECT * FROM "web_returns" WHERE "wr_return_amt" > 10000) AS "t64103" ON "t64102"."ws_order_number" = "t64103"."wr_order_number" AND "t64102"."ws_item_sk" = "t64103"."wr_item_sk") AS "t64104" INNER JOIN (SELECT * FROM "date_dim" WHERE "d_year" = 1998 AND "d_moy" = 11) AS "t64105" ON "t64104"."ws_sold_date_sk" = "t64105"."d_date_sk" GROUP BY "t64104"."ws_item_sk") AS "t64107") AS "t64108" WHERE "return_rank" <= 10 OR "currency_rank" <= 10 UNION SELECT 'catalog' AS "channel", "item", "return_ratio", "return_rank", "currency_rank" FROM (SELECT "t64116"."item", CAST("t64116"."f1" AS DECIMAL(15, 4)) / CAST("t64116"."f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("t64116"."f3" AS DECIMAL(15, 4)) / CAST("t64116"."f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("t64116"."f1" AS DECIMAL(15, 4)) / CAST("t64116"."f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("t64116"."f3" AS DECIMAL(15, 4)) / CAST("t64116"."f4" AS DECIMAL(15, 4))) AS "currency_rank" FROM (SELECT "t64113"."cs_item_sk" AS "item", SUM(CASE WHEN "t64113"."cr_return_quantity" IS NOT NULL THEN CAST("t64113"."cr_return_quantity" AS INTEGER) ELSE 0 END) AS "f1", SUM("t64113"."cs_quantity") AS "f2", SUM(CASE WHEN "t64113"."cr_return_amount" IS NOT NULL THEN CAST("t64113"."cr_return_amount" AS DECIMAL(19, 0)) ELSE 0 END) AS "f3", SUM("t64113"."cs_net_paid") AS "f4" FROM (SELECT "t64111"."cs_sold_date_sk", "t64111"."cs_sold_time_sk", "t64111"."cs_ship_date_sk", "t64111"."cs_bill_customer_sk", "t64111"."cs_bill_cdemo_sk", "t64111"."cs_bill_hdemo_sk", "t64111"."cs_bill_addr_sk", "t64111"."cs_ship_customer_sk", "t64111"."cs_ship_cdemo_sk", "t64111"."cs_ship_hdemo_sk", "t64111"."cs_ship_addr_sk", "t64111"."cs_call_center_sk", "t64111"."cs_catalog_page_sk", "t64111"."cs_ship_mode_sk", "t64111"."cs_warehouse_sk", "t64111"."cs_item_sk", "t64111"."cs_promo_sk", "t64111"."cs_order_number", "t64111"."cs_quantity", "t64111"."cs_wholesale_cost", "t64111"."cs_list_price", "t64111"."cs_sales_price", "t64111"."cs_ext_discount_amt", "t64111"."cs_ext_sales_price", "t64111"."cs_ext_wholesale_cost", "t64111"."cs_ext_list_price", "t64111"."cs_ext_tax", "t64111"."cs_coupon_amt", "t64111"."cs_ext_ship_cost", "t64111"."cs_net_paid", "t64111"."cs_net_paid_inc_tax", "t64111"."cs_net_paid_inc_ship", "t64111"."cs_net_paid_inc_ship_tax", "t64111"."cs_net_profit", CAST("t64112"."cr_returned_date_sk" AS INTEGER) AS "cr_returned_date_sk", CAST("t64112"."cr_returned_time_sk" AS INTEGER) AS "cr_returned_time_sk", CAST("t64112"."cr_item_sk" AS INTEGER) AS "cr_item_sk", CAST("t64112"."cr_refunded_customer_sk" AS INTEGER) AS "cr_refunded_customer_sk", CAST("t64112"."cr_refunded_cdemo_sk" AS INTEGER) AS "cr_refunded_cdemo_sk", CAST("t64112"."cr_refunded_hdemo_sk" AS INTEGER) AS "cr_refunded_hdemo_sk", CAST("t64112"."cr_refunded_addr_sk" AS INTEGER) AS "cr_refunded_addr_sk", CAST("t64112"."cr_returning_customer_sk" AS INTEGER) AS "cr_returning_customer_sk", CAST("t64112"."cr_returning_cdemo_sk" AS INTEGER) AS "cr_returning_cdemo_sk", CAST("t64112"."cr_returning_hdemo_sk" AS INTEGER) AS "cr_returning_hdemo_sk", CAST("t64112"."cr_returning_addr_sk" AS INTEGER) AS "cr_returning_addr_sk", CAST("t64112"."cr_call_center_sk" AS INTEGER) AS "cr_call_center_sk", CAST("t64112"."cr_catalog_page_sk" AS INTEGER) AS "cr_catalog_page_sk", CAST("t64112"."cr_ship_mode_sk" AS INTEGER) AS "cr_ship_mode_sk", CAST("t64112"."cr_warehouse_sk" AS INTEGER) AS "cr_warehouse_sk", CAST("t64112"."cr_reason_sk" AS INTEGER) AS "cr_reason_sk", CAST("t64112"."cr_order_number" AS INTEGER) AS "cr_order_number", CAST("t64112"."cr_return_quantity" AS INTEGER) AS "cr_return_quantity", CAST("t64112"."cr_return_amount" AS DECIMAL(19, 0)) AS "cr_return_amount", CAST("t64112"."cr_return_tax" AS DECIMAL(19, 0)) AS "cr_return_tax", CAST("t64112"."cr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "cr_return_amt_inc_tax", CAST("t64112"."cr_fee" AS DECIMAL(19, 0)) AS "cr_fee", CAST("t64112"."cr_return_ship_cost" AS DECIMAL(19, 0)) AS "cr_return_ship_cost", CAST("t64112"."cr_refunded_cash" AS DECIMAL(19, 0)) AS "cr_refunded_cash", CAST("t64112"."cr_reversed_charge" AS DECIMAL(19, 0)) AS "cr_reversed_charge", CAST("t64112"."cr_store_credit" AS DECIMAL(19, 0)) AS "cr_store_credit", CAST("t64112"."cr_net_loss" AS DECIMAL(19, 0)) AS "cr_net_loss" FROM (SELECT * FROM "catalog_sales" WHERE "cs_net_profit" > 1 AND "cs_net_paid" > 0 AND "cs_quantity" > 0) AS "t64111" INNER JOIN (SELECT * FROM "catalog_returns" WHERE "cr_return_amount" > 10000) AS "t64112" ON "t64111"."cs_order_number" = "t64112"."cr_order_number" AND "t64111"."cs_item_sk" = "t64112"."cr_item_sk") AS "t64113" INNER JOIN (SELECT * FROM "date_dim" WHERE "d_year" = 1998 AND "d_moy" = 11) AS "t64114" ON "t64113"."cs_sold_date_sk" = "t64114"."d_date_sk" GROUP BY "t64113"."cs_item_sk") AS "t64116") AS "t64117" WHERE "return_rank" <= 10 OR "currency_rank" <= 10) AS "t" UNION SELECT 'store' AS "channel", "item", "return_ratio", "return_rank", "currency_rank" FROM (SELECT "t64126"."item", CAST("t64126"."f1" AS DECIMAL(15, 4)) / CAST("t64126"."f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("t64126"."f3" AS DECIMAL(15, 4)) / CAST("t64126"."f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("t64126"."f1" AS DECIMAL(15, 4)) / CAST("t64126"."f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("t64126"."f3" AS DECIMAL(15, 4)) / CAST("t64126"."f4" AS DECIMAL(15, 4))) AS "currency_rank" FROM (SELECT "t64123"."ss_item_sk" AS "item", SUM(CASE WHEN "t64123"."sr_return_quantity" IS NOT NULL THEN CAST("t64123"."sr_return_quantity" AS INTEGER) ELSE 0 END) AS "f1", SUM("t64123"."ss_quantity") AS "f2", SUM(CASE WHEN "t64123"."sr_return_amt" IS NOT NULL THEN CAST("t64123"."sr_return_amt" AS DECIMAL(19, 0)) ELSE 0 END) AS "f3", SUM("t64123"."ss_net_paid") AS "f4" FROM (SELECT "t64121"."ss_sold_date_sk", "t64121"."ss_sold_time_sk", "t64121"."ss_item_sk", "t64121"."ss_customer_sk", "t64121"."ss_cdemo_sk", "t64121"."ss_hdemo_sk", "t64121"."ss_addr_sk", "t64121"."ss_store_sk", "t64121"."ss_promo_sk", "t64121"."ss_ticket_number", "t64121"."ss_quantity", "t64121"."ss_wholesale_cost", "t64121"."ss_list_price", "t64121"."ss_sales_price", "t64121"."ss_ext_discount_amt", "t64121"."ss_ext_sales_price", "t64121"."ss_ext_wholesale_cost", "t64121"."ss_ext_list_price", "t64121"."ss_ext_tax", "t64121"."ss_coupon_amt", "t64121"."ss_net_paid", "t64121"."ss_net_paid_inc_tax", "t64121"."ss_net_profit", CAST("t64122"."sr_returned_date_sk" AS INTEGER) AS "sr_returned_date_sk", CAST("t64122"."sr_return_time_sk" AS INTEGER) AS "sr_return_time_sk", CAST("t64122"."sr_item_sk" AS INTEGER) AS "sr_item_sk", CAST("t64122"."sr_customer_sk" AS INTEGER) AS "sr_customer_sk", CAST("t64122"."sr_cdemo_sk" AS INTEGER) AS "sr_cdemo_sk", CAST("t64122"."sr_hdemo_sk" AS INTEGER) AS "sr_hdemo_sk", CAST("t64122"."sr_addr_sk" AS INTEGER) AS "sr_addr_sk", CAST("t64122"."sr_store_sk" AS INTEGER) AS "sr_store_sk", CAST("t64122"."sr_reason_sk" AS INTEGER) AS "sr_reason_sk", CAST("t64122"."sr_ticket_number" AS INTEGER) AS "sr_ticket_number", CAST("t64122"."sr_return_quantity" AS INTEGER) AS "sr_return_quantity", CAST("t64122"."sr_return_amt" AS DECIMAL(19, 0)) AS "sr_return_amt", CAST("t64122"."sr_return_tax" AS DECIMAL(19, 0)) AS "sr_return_tax", CAST("t64122"."sr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "sr_return_amt_inc_tax", CAST("t64122"."sr_fee" AS DECIMAL(19, 0)) AS "sr_fee", CAST("t64122"."sr_return_ship_cost" AS DECIMAL(19, 0)) AS "sr_return_ship_cost", CAST("t64122"."sr_refunded_cash" AS DECIMAL(19, 0)) AS "sr_refunded_cash", CAST("t64122"."sr_reversed_charge" AS DECIMAL(19, 0)) AS "sr_reversed_charge", CAST("t64122"."sr_store_credit" AS DECIMAL(19, 0)) AS "sr_store_credit", CAST("t64122"."sr_net_loss" AS DECIMAL(19, 0)) AS "sr_net_loss" FROM (SELECT * FROM "store_sales" WHERE "ss_net_profit" > 1 AND "ss_net_paid" > 0 AND "ss_quantity" > 0) AS "t64121" INNER JOIN (SELECT * FROM "store_returns" WHERE "sr_return_amt" > 10000) AS "t64122" ON "t64121"."ss_ticket_number" = "t64122"."sr_ticket_number" AND "t64121"."ss_item_sk" = "t64122"."sr_item_sk") AS "t64123" INNER JOIN (SELECT * FROM "date_dim" WHERE "d_year" = 1998 AND "d_moy" = 11) AS "t64124" ON "t64123"."ss_sold_date_sk" = "t64124"."d_date_sk" GROUP BY "t64123"."ss_item_sk") AS "t64126") AS "t64127" WHERE "return_rank" <= 10 OR "currency_rank" <= 10) AS "t" ORDER BY "channel", "return_rank", "currency_rank", "item" FETCH NEXT 100 ROWS ONLY