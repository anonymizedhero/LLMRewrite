SELECT "i_category", "i_class", "i_brand", "s_store_name", "s_company_name", "d_moy", "sum_sales", "avg_monthly_sales" FROM (SELECT "t127972"."i_category", "t127972"."i_class", "t127972"."i_brand", "t127972"."s_store_name", "t127972"."s_company_name", "t127972"."d_moy", "t127972"."sum_sales", (SUM("t127972"."sum_sales") OVER (PARTITION BY "t127972"."i_category", "t127972"."i_brand", "t127972"."s_store_name", "t127972"."s_company_name" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) / (COUNT("t127972"."sum_sales") OVER (PARTITION BY "t127972"."i_category", "t127972"."i_brand", "t127972"."s_store_name", "t127972"."s_company_name" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS "avg_monthly_sales" FROM (SELECT "t127968"."i_category", "t127968"."i_class", "t127968"."i_brand", "t127969"."s_store_name", "t127969"."s_company_name", "t127968"."d_moy", SUM("t127968"."sum_sales" * "t127969"."f3") AS "sum_sales" FROM (SELECT "t127964"."i_brand", "t127964"."i_class", "t127964"."i_category", "t127964"."ss_store_sk", "t127966"."d_moy", SUM("t127964"."sum_sales" * "t127966"."f2") AS "sum_sales" FROM (SELECT "t127961"."i_brand", "t127961"."i_class", "t127961"."i_category", "t127962"."ss_sold_date_sk", "t127962"."ss_store_sk", SUM("t127961"."f4" * "t127962"."sum_sales") AS "sum_sales" FROM (SELECT "i_item_sk", "i_brand", "i_class", "i_category", COUNT(*) AS "f4" FROM "item" WHERE "i_category" IN ('Books', 'Children', 'Electronics') AND "i_class" IN ('audio', 'history', 'school-uniforms') OR "i_category" IN ('Men', 'Shoes', 'Sports') AND "i_class" IN ('pants', 'tennis', 'womens') GROUP BY "i_item_sk", "i_brand", "i_class", "i_category") AS "t127961" INNER JOIN (SELECT "ss_sold_date_sk", "ss_item_sk", "ss_store_sk", SUM("ss_sales_price") AS "sum_sales" FROM "store_sales" GROUP BY "ss_sold_date_sk", "ss_item_sk", "ss_store_sk") AS "t127962" ON "t127961"."i_item_sk" = "t127962"."ss_item_sk" GROUP BY "t127961"."i_brand", "t127961"."i_class", "t127961"."i_category", "t127962"."ss_sold_date_sk", "t127962"."ss_store_sk") AS "t127964" INNER JOIN (SELECT "d_date_sk", "d_moy", COUNT(*) AS "f2" FROM "date_dim" WHERE "d_year" = 2001 GROUP BY "d_date_sk", "d_moy") AS "t127966" ON "t127964"."ss_sold_date_sk" = "t127966"."d_date_sk" GROUP BY "t127964"."i_brand", "t127964"."i_class", "t127964"."i_category", "t127964"."ss_store_sk", "t127966"."d_moy") AS "t127968" INNER JOIN (SELECT "s_store_sk", "s_store_name", "s_company_name", COUNT(*) AS "f3" FROM "store" GROUP BY "s_store_sk", "s_store_name", "s_company_name") AS "t127969" ON "t127968"."ss_store_sk" = "t127969"."s_store_sk" GROUP BY "t127968"."i_brand", "t127968"."i_class", "t127968"."i_category", "t127968"."d_moy", "t127969"."s_store_name", "t127969"."s_company_name") AS "t127972") AS "t127973" WHERE CASE WHEN "avg_monthly_sales" <> 0 THEN ABS("sum_sales" - "avg_monthly_sales") / "avg_monthly_sales" > 0.1 ELSE FALSE END ORDER BY "sum_sales" - "avg_monthly_sales", "s_store_name" FETCH NEXT 100 ROWS ONLY