SELECT "t80560"."i_category", "t80560"."i_brand", "t80560"."cc_name", "t80560"."d_year", "t80560"."avg_monthly_sales", "t80560"."sum_sales", "t80573"."sum_sales" AS "psum", "t80586"."sum_sales" AS "nsum" FROM (SELECT * FROM (SELECT "t80558"."i_category", "t80558"."i_brand", "t80558"."cc_name", "t80558"."d_year", "t80558"."d_moy", "t80558"."sum_sales", (SUM("t80558"."sum_sales") OVER (PARTITION BY "t80558"."i_category", "t80558"."i_brand", "t80558"."cc_name", "t80558"."d_year" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) / (COUNT("t80558"."sum_sales") OVER (PARTITION BY "t80558"."i_category", "t80558"."i_brand", "t80558"."cc_name", "t80558"."d_year" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS "avg_monthly_sales", RANK() OVER (PARTITION BY "t80558"."i_category", "t80558"."i_brand", "t80558"."cc_name" ORDER BY "t80558"."d_year", "t80558"."d_moy") AS "rn" FROM (SELECT "t80554"."i_category", "t80554"."i_brand", "t80555"."cc_name", "t80554"."d_year", "t80554"."d_moy", SUM("t80554"."sum_sales" * "t80555"."f2") AS "sum_sales" FROM (SELECT "t80550"."i_brand", "t80550"."i_category", "t80550"."cs_call_center_sk", "t80552"."d_year", "t80552"."d_moy", SUM("t80550"."sum_sales" * "t80552"."f3") AS "sum_sales" FROM (SELECT "t80547"."i_brand", "t80547"."i_category", "t80548"."cs_sold_date_sk", "t80548"."cs_call_center_sk", SUM("t80547"."f3" * "t80548"."sum_sales") AS "sum_sales" FROM (SELECT "i_item_sk", "i_brand", "i_category", COUNT(*) AS "f3" FROM "item" GROUP BY "i_item_sk", "i_brand", "i_category") AS "t80547" INNER JOIN (SELECT "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk", SUM("cs_sales_price") AS "sum_sales" FROM "catalog_sales" GROUP BY "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk") AS "t80548" ON "t80547"."i_item_sk" = "t80548"."cs_item_sk" GROUP BY "t80547"."i_brand", "t80547"."i_category", "t80548"."cs_sold_date_sk", "t80548"."cs_call_center_sk") AS "t80550" INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", COUNT(*) AS "f3" FROM "date_dim" WHERE "d_year" = 2001 OR "d_year" = 2001 - 1 AND "d_moy" = 12 OR "d_year" = 2001 + 1 AND "d_moy" = 1 GROUP BY "d_date_sk", "d_year", "d_moy") AS "t80552" ON "t80550"."cs_sold_date_sk" = "t80552"."d_date_sk" GROUP BY "t80550"."i_brand", "t80550"."i_category", "t80550"."cs_call_center_sk", "t80552"."d_year", "t80552"."d_moy") AS "t80554" INNER JOIN (SELECT "cc_call_center_sk", "cc_name", COUNT(*) AS "f2" FROM "call_center" GROUP BY "cc_call_center_sk", "cc_name") AS "t80555" ON "t80554"."cs_call_center_sk" = "t80555"."cc_call_center_sk" GROUP BY "t80554"."i_brand", "t80554"."i_category", "t80554"."d_year", "t80554"."d_moy", "t80555"."cc_name") AS "t80558") AS "t80559" WHERE "d_year" = 2001 AND "avg_monthly_sales" > 0 AND CASE WHEN "avg_monthly_sales" > 0 THEN ABS("sum_sales" - "avg_monthly_sales") / "avg_monthly_sales" > 0.1 ELSE FALSE END) AS "t80560" INNER JOIN (SELECT "t80572"."i_category", "t80572"."i_brand", "t80572"."cc_name", "t80572"."d_year", "t80572"."d_moy", "t80572"."sum_sales", (SUM("t80572"."sum_sales") OVER (PARTITION BY "t80572"."i_category", "t80572"."i_brand", "t80572"."cc_name", "t80572"."d_year" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) / (COUNT("t80572"."sum_sales") OVER (PARTITION BY "t80572"."i_category", "t80572"."i_brand", "t80572"."cc_name", "t80572"."d_year" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS "avg_monthly_sales", RANK() OVER (PARTITION BY "t80572"."i_category", "t80572"."i_brand", "t80572"."cc_name" ORDER BY "t80572"."d_year", "t80572"."d_moy") AS "rn" FROM (SELECT "t80568"."i_category", "t80568"."i_brand", "t80569"."cc_name", "t80568"."d_year", "t80568"."d_moy", SUM("t80568"."sum_sales" * "t80569"."f2") AS "sum_sales" FROM (SELECT "t80564"."i_brand", "t80564"."i_category", "t80564"."cs_call_center_sk", "t80566"."d_year", "t80566"."d_moy", SUM("t80564"."sum_sales" * "t80566"."f3") AS "sum_sales" FROM (SELECT "t80561"."i_brand", "t80561"."i_category", "t80562"."cs_sold_date_sk", "t80562"."cs_call_center_sk", SUM("t80561"."f3" * "t80562"."sum_sales") AS "sum_sales" FROM (SELECT "i_item_sk", "i_brand", "i_category", COUNT(*) AS "f3" FROM "item" GROUP BY "i_item_sk", "i_brand", "i_category") AS "t80561" INNER JOIN (SELECT "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk", SUM("cs_sales_price") AS "sum_sales" FROM "catalog_sales" GROUP BY "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk") AS "t80562" ON "t80561"."i_item_sk" = "t80562"."cs_item_sk" GROUP BY "t80561"."i_brand", "t80561"."i_category", "t80562"."cs_sold_date_sk", "t80562"."cs_call_center_sk") AS "t80564" INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", COUNT(*) AS "f3" FROM "date_dim" WHERE "d_year" = 2001 OR "d_year" = 2001 - 1 AND "d_moy" = 12 OR "d_year" = 2001 + 1 AND "d_moy" = 1 GROUP BY "d_date_sk", "d_year", "d_moy") AS "t80566" ON "t80564"."cs_sold_date_sk" = "t80566"."d_date_sk" GROUP BY "t80564"."i_brand", "t80564"."i_category", "t80564"."cs_call_center_sk", "t80566"."d_year", "t80566"."d_moy") AS "t80568" INNER JOIN (SELECT "cc_call_center_sk", "cc_name", COUNT(*) AS "f2" FROM "call_center" GROUP BY "cc_call_center_sk", "cc_name") AS "t80569" ON "t80568"."cs_call_center_sk" = "t80569"."cc_call_center_sk" GROUP BY "t80568"."i_brand", "t80568"."i_category", "t80568"."d_year", "t80568"."d_moy", "t80569"."cc_name") AS "t80572") AS "t80573" ON "t80560"."i_category" = "t80573"."i_category" AND "t80560"."i_brand" = "t80573"."i_brand" AND "t80560"."cc_name" = "t80573"."cc_name" AND "t80560"."rn" = "t80573"."rn" + 1 INNER JOIN (SELECT "t80585"."i_category", "t80585"."i_brand", "t80585"."cc_name", "t80585"."d_year", "t80585"."d_moy", "t80585"."sum_sales", (SUM("t80585"."sum_sales") OVER (PARTITION BY "t80585"."i_category", "t80585"."i_brand", "t80585"."cc_name", "t80585"."d_year" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) / (COUNT("t80585"."sum_sales") OVER (PARTITION BY "t80585"."i_category", "t80585"."i_brand", "t80585"."cc_name", "t80585"."d_year" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS "avg_monthly_sales", RANK() OVER (PARTITION BY "t80585"."i_category", "t80585"."i_brand", "t80585"."cc_name" ORDER BY "t80585"."d_year", "t80585"."d_moy") AS "rn" FROM (SELECT "t80581"."i_category", "t80581"."i_brand", "t80582"."cc_name", "t80581"."d_year", "t80581"."d_moy", SUM("t80581"."sum_sales" * "t80582"."f2") AS "sum_sales" FROM (SELECT "t80577"."i_brand", "t80577"."i_category", "t80577"."cs_call_center_sk", "t80579"."d_year", "t80579"."d_moy", SUM("t80577"."sum_sales" * "t80579"."f3") AS "sum_sales" FROM (SELECT "t80574"."i_brand", "t80574"."i_category", "t80575"."cs_sold_date_sk", "t80575"."cs_call_center_sk", SUM("t80574"."f3" * "t80575"."sum_sales") AS "sum_sales" FROM (SELECT "i_item_sk", "i_brand", "i_category", COUNT(*) AS "f3" FROM "item" GROUP BY "i_item_sk", "i_brand", "i_category") AS "t80574" INNER JOIN (SELECT "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk", SUM("cs_sales_price") AS "sum_sales" FROM "catalog_sales" GROUP BY "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk") AS "t80575" ON "t80574"."i_item_sk" = "t80575"."cs_item_sk" GROUP BY "t80574"."i_brand", "t80574"."i_category", "t80575"."cs_sold_date_sk", "t80575"."cs_call_center_sk") AS "t80577" INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", COUNT(*) AS "f3" FROM "date_dim" WHERE "d_year" = 2001 OR "d_year" = 2001 - 1 AND "d_moy" = 12 OR "d_year" = 2001 + 1 AND "d_moy" = 1 GROUP BY "d_date_sk", "d_year", "d_moy") AS "t80579" ON "t80577"."cs_sold_date_sk" = "t80579"."d_date_sk" GROUP BY "t80577"."i_brand", "t80577"."i_category", "t80577"."cs_call_center_sk", "t80579"."d_year", "t80579"."d_moy") AS "t80581" INNER JOIN (SELECT "cc_call_center_sk", "cc_name", COUNT(*) AS "f2" FROM "call_center" GROUP BY "cc_call_center_sk", "cc_name") AS "t80582" ON "t80581"."cs_call_center_sk" = "t80582"."cc_call_center_sk" GROUP BY "t80581"."i_brand", "t80581"."i_category", "t80581"."d_year", "t80581"."d_moy", "t80582"."cc_name") AS "t80585") AS "t80586" ON "t80560"."i_category" = "t80586"."i_category" AND "t80560"."i_brand" = "t80586"."i_brand" AND "t80560"."cc_name" = "t80586"."cc_name" AND "t80560"."rn" = "t80586"."rn" - 1 ORDER BY "t80560"."sum_sales" - "t80560"."avg_monthly_sales", "t80560"."avg_monthly_sales" FETCH NEXT 100 ROWS ONLY