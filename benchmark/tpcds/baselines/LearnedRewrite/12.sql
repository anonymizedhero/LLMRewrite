SELECT "t22259"."i_item_id", "t22259"."i_item_desc", "t22259"."i_category", "t22259"."i_class", "t22259"."i_current_price", "t22259"."itemrevenue", "t22259"."itemrevenue" * 100 / (SUM("t22259"."itemrevenue") OVER (PARTITION BY "t22259"."i_class" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS "revenueratio" FROM (SELECT "t22254"."i_item_id", "t22254"."i_item_desc", "t22254"."i_category", "t22254"."i_class", "t22254"."i_current_price", SUM("t22254"."itemrevenue" * "t22256"."f1") AS "itemrevenue" FROM (SELECT "t22250"."ws_sold_date_sk", "t22252"."i_item_id", "t22252"."i_item_desc", "t22252"."i_current_price", "t22252"."i_class", "t22252"."i_category", SUM("t22250"."itemrevenue" * "t22252"."f6") AS "itemrevenue" FROM (SELECT "ws_sold_date_sk", "ws_item_sk", SUM("ws_ext_sales_price") AS "itemrevenue" FROM "web_sales" GROUP BY "ws_sold_date_sk", "ws_item_sk") AS "t22250" INNER JOIN (SELECT "i_item_sk", "i_item_id", "i_item_desc", "i_current_price", "i_class", "i_category", COUNT(*) AS "f6" FROM "item" WHERE "i_category" IN ('Books', 'Electronics', 'Men') GROUP BY "i_item_sk", "i_item_id", "i_item_desc", "i_current_price", "i_class", "i_category") AS "t22252" ON "t22250"."ws_item_sk" = "t22252"."i_item_sk" GROUP BY "t22250"."ws_sold_date_sk", "t22252"."i_item_id", "t22252"."i_item_desc", "t22252"."i_current_price", "t22252"."i_class", "t22252"."i_category") AS "t22254" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_date" >= DATE '2001-06-15' AND "d_date" <= (DATE '2001-06-15' + INTERVAL '30' DAY) GROUP BY "d_date_sk") AS "t22256" ON "t22254"."ws_sold_date_sk" = "t22256"."d_date_sk" GROUP BY "t22254"."i_item_id", "t22254"."i_item_desc", "t22254"."i_current_price", "t22254"."i_class", "t22254"."i_category") AS "t22259" ORDER BY "t22259"."i_category", "t22259"."i_class", "t22259"."i_item_id", "t22259"."i_item_desc", "t22259"."itemrevenue" * 100 / (SUM("t22259"."itemrevenue") OVER (PARTITION BY "t22259"."i_class" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) FETCH NEXT 100 ROWS ONLY