SELECT "t104246"."cd_gender", "t104246"."cd_marital_status", "t104246"."cd_education_status", COUNT(*) AS "cnt1", "t104246"."cd_purchase_estimate", COUNT(*) AS "cnt2", "t104246"."cd_credit_rating", COUNT(*) AS "cnt3" FROM (SELECT "t104240"."c_customer_sk", "t104240"."c_customer_id", "t104240"."c_current_cdemo_sk", "t104240"."c_current_hdemo_sk", "t104240"."c_current_addr_sk", "t104240"."c_first_shipto_date_sk", "t104240"."c_first_sales_date_sk", "t104240"."c_salutation", "t104240"."c_first_name", "t104240"."c_last_name", "t104240"."c_preferred_cust_flag", "t104240"."c_birth_day", "t104240"."c_birth_month", "t104240"."c_birth_year", "t104240"."c_birth_country", "t104240"."c_login", "t104240"."c_email_address", "t104240"."c_last_review_date_sk", "t104240"."ca_address_sk", "t104240"."ca_address_id", "t104240"."ca_street_number", "t104240"."ca_street_name", "t104240"."ca_street_type", "t104240"."ca_suite_number", "t104240"."ca_city", "t104240"."ca_county", "t104240"."ca_state", "t104240"."ca_zip", "t104240"."ca_country", "t104240"."ca_gmt_offset", "t104240"."ca_location_type", "t104240"."cd_demo_sk", "t104240"."cd_gender", "t104240"."cd_marital_status", "t104240"."cd_education_status", "t104240"."cd_purchase_estimate", "t104240"."cd_credit_rating", "t104240"."cd_dep_count", "t104240"."cd_dep_employed_count", "t104240"."cd_dep_college_count", "t104240"."f0", "t104244"."f1" AS "f041" FROM (SELECT "customer4182"."c_customer_sk", "customer4182"."c_customer_id", "customer4182"."c_current_cdemo_sk", "customer4182"."c_current_hdemo_sk", "customer4182"."c_current_addr_sk", "customer4182"."c_first_shipto_date_sk", "customer4182"."c_first_sales_date_sk", "customer4182"."c_salutation", "customer4182"."c_first_name", "customer4182"."c_last_name", "customer4182"."c_preferred_cust_flag", "customer4182"."c_birth_day", "customer4182"."c_birth_month", "customer4182"."c_birth_year", "customer4182"."c_birth_country", "customer4182"."c_login", "customer4182"."c_email_address", "customer4182"."c_last_review_date_sk", "customer_address4114"."ca_address_sk", "customer_address4114"."ca_address_id", "customer_address4114"."ca_street_number", "customer_address4114"."ca_street_name", "customer_address4114"."ca_street_type", "customer_address4114"."ca_suite_number", "customer_address4114"."ca_city", "customer_address4114"."ca_county", "customer_address4114"."ca_state", "customer_address4114"."ca_zip", "customer_address4114"."ca_country", "customer_address4114"."ca_gmt_offset", "customer_address4114"."ca_location_type", "customer_demographics1367"."cd_demo_sk", "customer_demographics1367"."cd_gender", "customer_demographics1367"."cd_marital_status", "customer_demographics1367"."cd_education_status", "customer_demographics1367"."cd_purchase_estimate", "customer_demographics1367"."cd_credit_rating", "customer_demographics1367"."cd_dep_count", "customer_demographics1367"."cd_dep_employed_count", "customer_demographics1367"."cd_dep_college_count", "t104239"."f1" AS "f0" FROM "customer" AS "customer4182" CROSS JOIN "customer_address" AS "customer_address4114" CROSS JOIN "customer_demographics" AS "customer_demographics1367" LEFT JOIN (SELECT "store_sales8180"."ss_customer_sk", MIN(TRUE) AS "f1" FROM "store_sales" AS "store_sales8180", (SELECT * FROM "date_dim" WHERE "d_year" = 2002 AND "d_moy" >= 1 AND "d_moy" <= 1 + 2) AS "t104236" WHERE "store_sales8180"."ss_sold_date_sk" = "t104236"."d_date_sk" GROUP BY "store_sales8180"."ss_customer_sk") AS "t104239" ON "customer4182"."c_customer_sk" = "t104239"."ss_customer_sk") AS "t104240" LEFT JOIN (SELECT "web_sales2978"."ws_bill_customer_sk", MIN(TRUE) AS "f1" FROM "web_sales" AS "web_sales2978", (SELECT * FROM "date_dim" WHERE "d_year" = 2002 AND "d_moy" >= 1 AND "d_moy" <= 1 + 2) AS "t104241" WHERE "web_sales2978"."ws_sold_date_sk" = "t104241"."d_date_sk" GROUP BY "web_sales2978"."ws_bill_customer_sk") AS "t104244" ON "t104240"."c_customer_sk" = "t104244"."ws_bill_customer_sk" WHERE "t104240"."c_current_addr_sk" = "t104240"."ca_address_sk" AND "t104240"."ca_state" IN ('IL', 'ME', 'TX') AND "t104240"."cd_demo_sk" = "t104240"."c_current_cdemo_sk" AND "t104244"."f1" IS NULL AND "t104240"."f0" IS NOT NULL) AS "t104246" LEFT JOIN (SELECT "catalog_sales3206"."cs_ship_customer_sk", MIN(TRUE) AS "f1" FROM "catalog_sales" AS "catalog_sales3206", (SELECT * FROM "date_dim" WHERE "d_year" = 2002 AND "d_moy" >= 1 AND "d_moy" <= 1 + 2) AS "t104247" WHERE "catalog_sales3206"."cs_sold_date_sk" = "t104247"."d_date_sk" GROUP BY "catalog_sales3206"."cs_ship_customer_sk") AS "t104250" ON "t104246"."c_customer_sk" = "t104250"."cs_ship_customer_sk" WHERE "t104250"."f1" IS NULL GROUP BY "t104246"."cd_gender", "t104246"."cd_marital_status", "t104246"."cd_education_status", "t104246"."cd_purchase_estimate", "t104246"."cd_credit_rating" ORDER BY "t104246"."cd_gender", "t104246"."cd_marital_status", "t104246"."cd_education_status", "t104246"."cd_purchase_estimate", "t104246"."cd_credit_rating" FETCH NEXT 100 ROWS ONLY