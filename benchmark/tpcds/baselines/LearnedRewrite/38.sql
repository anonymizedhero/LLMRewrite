SELECT COUNT(*) FROM (SELECT * FROM (SELECT "t51588"."c_last_name", "t51588"."c_first_name", "t51587"."d_date" FROM (SELECT "t51584"."ss_customer_sk", "t51586"."d_date" FROM (SELECT "ss_sold_date_sk", "ss_customer_sk" FROM "store_sales" GROUP BY "ss_sold_date_sk", "ss_customer_sk") AS "t51584" INNER JOIN (SELECT "d_date_sk", "d_date" FROM "date_dim" WHERE "d_month_seq" >= 1189 AND "d_month_seq" <= 1189 + 11 GROUP BY "d_date_sk", "d_date") AS "t51586" ON "t51584"."ss_sold_date_sk" = "t51586"."d_date_sk" GROUP BY "t51584"."ss_customer_sk", "t51586"."d_date") AS "t51587" INNER JOIN (SELECT "c_customer_sk", "c_first_name", "c_last_name" FROM "customer" GROUP BY "c_customer_sk", "c_first_name", "c_last_name") AS "t51588" ON "t51587"."ss_customer_sk" = "t51588"."c_customer_sk" GROUP BY "t51587"."d_date", "t51588"."c_first_name", "t51588"."c_last_name" INTERSECT SELECT "t51595"."c_last_name", "t51595"."c_first_name", "t51594"."d_date" FROM (SELECT "t51591"."cs_bill_customer_sk", "t51593"."d_date" FROM (SELECT "cs_sold_date_sk", "cs_bill_customer_sk" FROM "catalog_sales" GROUP BY "cs_sold_date_sk", "cs_bill_customer_sk") AS "t51591" INNER JOIN (SELECT "d_date_sk", "d_date" FROM "date_dim" WHERE "d_month_seq" >= 1189 AND "d_month_seq" <= 1189 + 11 GROUP BY "d_date_sk", "d_date") AS "t51593" ON "t51591"."cs_sold_date_sk" = "t51593"."d_date_sk" GROUP BY "t51591"."cs_bill_customer_sk", "t51593"."d_date") AS "t51594" INNER JOIN (SELECT "c_customer_sk", "c_first_name", "c_last_name" FROM "customer" GROUP BY "c_customer_sk", "c_first_name", "c_last_name") AS "t51595" ON "t51594"."cs_bill_customer_sk" = "t51595"."c_customer_sk" GROUP BY "t51594"."d_date", "t51595"."c_first_name", "t51595"."c_last_name") AS "t" INTERSECT SELECT "t51603"."c_last_name", "t51603"."c_first_name", "t51602"."d_date" FROM (SELECT "t51599"."ws_bill_customer_sk", "t51601"."d_date" FROM (SELECT "ws_sold_date_sk", "ws_bill_customer_sk" FROM "web_sales" GROUP BY "ws_sold_date_sk", "ws_bill_customer_sk") AS "t51599" INNER JOIN (SELECT "d_date_sk", "d_date" FROM "date_dim" WHERE "d_month_seq" >= 1189 AND "d_month_seq" <= 1189 + 11 GROUP BY "d_date_sk", "d_date") AS "t51601" ON "t51599"."ws_sold_date_sk" = "t51601"."d_date_sk" GROUP BY "t51599"."ws_bill_customer_sk", "t51601"."d_date") AS "t51602" INNER JOIN (SELECT "c_customer_sk", "c_first_name", "c_last_name" FROM "customer" GROUP BY "c_customer_sk", "c_first_name", "c_last_name") AS "t51603" ON "t51602"."ws_bill_customer_sk" = "t51603"."c_customer_sk" GROUP BY "t51602"."d_date", "t51603"."c_first_name", "t51603"."c_last_name") AS "t51606" FETCH NEXT 100 ROWS ONLY