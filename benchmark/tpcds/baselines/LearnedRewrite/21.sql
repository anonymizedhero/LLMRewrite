SELECT "warehouse65"."w_warehouse_name", "t28403"."i_item_id", SUM(CASE WHEN "t28404"."d_date" < DATE '1999-06-22' THEN "inventory65"."inv_quantity_on_hand" ELSE 0 END) AS "inv_before", SUM(CASE WHEN "t28404"."d_date" >= DATE '1999-06-22' THEN "inventory65"."inv_quantity_on_hand" ELSE 0 END) AS "inv_after" FROM "inventory" AS "inventory65" INNER JOIN "warehouse" AS "warehouse65" ON "inventory65"."inv_warehouse_sk" = "warehouse65"."w_warehouse_sk" INNER JOIN (SELECT * FROM "item" WHERE "i_current_price" >= 0.99 AND "i_current_price" <= 1.49) AS "t28403" ON "inventory65"."inv_item_sk" = "t28403"."i_item_sk" INNER JOIN (SELECT * FROM "date_dim" WHERE "d_date" >= (DATE '1999-06-22' - INTERVAL '30' DAY) AND "d_date" <= (DATE '1999-06-22' + INTERVAL '30' DAY)) AS "t28404" ON "inventory65"."inv_date_sk" = "t28404"."d_date_sk" GROUP BY "warehouse65"."w_warehouse_name", "t28403"."i_item_id" HAVING CASE WHEN SUM(CASE WHEN "t28404"."d_date" < DATE '1999-06-22' THEN "inventory65"."inv_quantity_on_hand" ELSE 0 END) > 0 THEN SUM(CASE WHEN "t28404"."d_date" >= DATE '1999-06-22' THEN "inventory65"."inv_quantity_on_hand" ELSE 0 END) / SUM(CASE WHEN "t28404"."d_date" < DATE '1999-06-22' THEN "inventory65"."inv_quantity_on_hand" ELSE 0 END) >= 2.0 / 3.0 ELSE FALSE END AND CASE WHEN SUM(CASE WHEN "t28404"."d_date" < DATE '1999-06-22' THEN "inventory65"."inv_quantity_on_hand" ELSE 0 END) > 0 THEN SUM(CASE WHEN "t28404"."d_date" >= DATE '1999-06-22' THEN "inventory65"."inv_quantity_on_hand" ELSE 0 END) / SUM(CASE WHEN "t28404"."d_date" < DATE '1999-06-22' THEN "inventory65"."inv_quantity_on_hand" ELSE 0 END) <= 3.0 / 2.0 ELSE FALSE END ORDER BY "warehouse65"."w_warehouse_name", "t28403"."i_item_id" FETCH NEXT 100 ROWS ONLY