SELECT "i_category", "i_class", "i_brand", "i_product_name", "d_year", "d_qoy", "d_moy", "s_store_id", "sumsales", "rk" FROM (SELECT "t100870"."i_category", "t100870"."i_class", "t100870"."i_brand", "t100870"."i_product_name", "t100870"."d_year", "t100870"."d_qoy", "t100870"."d_moy", "t100870"."s_store_id", "t100870"."sumsales", RANK() OVER (PARTITION BY "t100870"."i_category" ORDER BY "t100870"."sumsales" DESC) AS "rk" FROM (SELECT "item6809"."i_category", "item6809"."i_class", "item6809"."i_brand", "item6809"."i_product_name", "t100868"."d_year", "t100868"."d_qoy", "t100868"."d_moy", "store2629"."s_store_id", SUM("store_sales7934"."ss_sales_price" * "store_sales7934"."ss_quantity") AS "sumsales" FROM "store_sales" AS "store_sales7934" INNER JOIN (SELECT * FROM "date_dim" WHERE "d_month_seq" >= 1217 AND "d_month_seq" <= 1217 + 11) AS "t100868" ON "store_sales7934"."ss_sold_date_sk" = "t100868"."d_date_sk" INNER JOIN "store" AS "store2629" ON "store_sales7934"."ss_store_sk" = "store2629"."s_store_sk" INNER JOIN "item" AS "item6809" ON "store_sales7934"."ss_item_sk" = "item6809"."i_item_sk" GROUP BY ROLLUP("item6809"."i_category", "item6809"."i_class", "item6809"."i_brand", "item6809"."i_product_name", "t100868"."d_year", "t100868"."d_qoy", "t100868"."d_moy", "store2629"."s_store_id")) AS "t100870") AS "t100871" WHERE "rk" <= 100 ORDER BY "i_category", "i_class", "i_brand", "i_product_name", "d_year", "d_qoy", "d_moy", "s_store_id", "sumsales", "rk" FETCH NEXT 100 ROWS ONLY