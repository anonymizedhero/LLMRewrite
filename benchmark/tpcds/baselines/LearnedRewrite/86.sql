SELECT SUM("web_sales3326"."ws_net_paid") AS "total_sum", "item7540"."i_category", "item7540"."i_class", GROUPING("item7540"."i_category") + GROUPING("item7540"."i_class") AS "lochierarchy", RANK() OVER (PARTITION BY GROUPING("item7540"."i_category") + GROUPING("item7540"."i_class"), CASE WHEN GROUPING("item7540"."i_class") = 0 THEN "item7540"."i_category" ELSE NULL END ORDER BY SUM("web_sales3326"."ws_net_paid") DESC) AS "rank_within_parent" FROM "web_sales" AS "web_sales3326" INNER JOIN (SELECT * FROM "date_dim" WHERE "d_month_seq" >= 1186 AND "d_month_seq" <= 1186 + 11) AS "t120240" ON "web_sales3326"."ws_sold_date_sk" = "t120240"."d_date_sk" INNER JOIN "item" AS "item7540" ON "web_sales3326"."ws_item_sk" = "item7540"."i_item_sk" GROUP BY ROLLUP("item7540"."i_class", "item7540"."i_category") ORDER BY GROUPING("item7540"."i_category") + GROUPING("item7540"."i_class") DESC, CASE WHEN GROUPING("item7540"."i_category") + GROUPING("item7540"."i_class") = 0 THEN "item7540"."i_category" ELSE NULL END, RANK() OVER (PARTITION BY GROUPING("item7540"."i_category") + GROUPING("item7540"."i_class"), CASE WHEN GROUPING("item7540"."i_class") = 0 THEN "item7540"."i_category" ELSE NULL END ORDER BY SUM("web_sales3326"."ws_net_paid") DESC) FETCH NEXT 100 ROWS ONLY