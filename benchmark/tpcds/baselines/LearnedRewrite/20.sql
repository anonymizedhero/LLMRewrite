SELECT "t27266"."i_item_id", "t27266"."i_item_desc", "t27266"."i_category", "t27266"."i_class", "t27266"."i_current_price", "t27266"."itemrevenue", "t27266"."itemrevenue" * 100 / (SUM("t27266"."itemrevenue") OVER (PARTITION BY "t27266"."i_class" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS "revenueratio" FROM (SELECT "t27261"."i_item_id", "t27261"."i_item_desc", "t27261"."i_category", "t27261"."i_class", "t27261"."i_current_price", SUM("t27261"."itemrevenue" * "t27263"."f1") AS "itemrevenue" FROM (SELECT "t27257"."cs_sold_date_sk", "t27259"."i_item_id", "t27259"."i_item_desc", "t27259"."i_current_price", "t27259"."i_class", "t27259"."i_category", SUM("t27257"."itemrevenue" * "t27259"."f6") AS "itemrevenue" FROM (SELECT "cs_sold_date_sk", "cs_item_sk", SUM("cs_ext_sales_price") AS "itemrevenue" FROM "catalog_sales" GROUP BY "cs_sold_date_sk", "cs_item_sk") AS "t27257" INNER JOIN (SELECT "i_item_sk", "i_item_id", "i_item_desc", "i_current_price", "i_class", "i_category", COUNT(*) AS "f6" FROM "item" WHERE "i_category" IN ('Books', 'Music', 'Sports') GROUP BY "i_item_sk", "i_item_id", "i_item_desc", "i_current_price", "i_class", "i_category") AS "t27259" ON "t27257"."cs_item_sk" = "t27259"."i_item_sk" GROUP BY "t27257"."cs_sold_date_sk", "t27259"."i_item_id", "t27259"."i_item_desc", "t27259"."i_current_price", "t27259"."i_class", "t27259"."i_category") AS "t27261" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_date" >= DATE '2002-06-18' AND "d_date" <= (DATE '2002-06-18' + INTERVAL '30' DAY) GROUP BY "d_date_sk") AS "t27263" ON "t27261"."cs_sold_date_sk" = "t27263"."d_date_sk" GROUP BY "t27261"."i_item_id", "t27261"."i_item_desc", "t27261"."i_current_price", "t27261"."i_class", "t27261"."i_category") AS "t27266" ORDER BY "t27266"."i_category", "t27266"."i_class", "t27266"."i_item_id", "t27266"."i_item_desc", "t27266"."itemrevenue" * 100 / (SUM("t27266"."itemrevenue") OVER (PARTITION BY "t27266"."i_class" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) FETCH NEXT 100 ROWS ONLY