SELECT "t101723"."c_last_name", "t101723"."c_first_name", "customer_address3887"."ca_city", "t101723"."bought_city", "t101723"."ss_ticket_number", "t101723"."extended_price", "t101723"."extended_tax", "t101723"."list_price" FROM (SELECT * FROM (SELECT "t101719"."ss_ticket_number", "t101719"."ss_customer_sk", "t101719"."ca_city" AS "bought_city", "t101719"."extended_price" * "t101719"."f2" AS "extended_price", "t101719"."list_price" * "t101719"."f2" AS "list_price", "t101719"."extended_tax" * "t101719"."f2" AS "extended_tax", "customer4032"."c_customer_sk", "customer4032"."c_customer_id", "customer4032"."c_current_cdemo_sk", "customer4032"."c_current_hdemo_sk", "customer4032"."c_current_addr_sk", "customer4032"."c_first_shipto_date_sk", "customer4032"."c_first_sales_date_sk", "customer4032"."c_salutation", "customer4032"."c_first_name", "customer4032"."c_last_name", "customer4032"."c_preferred_cust_flag", "customer4032"."c_birth_day", "customer4032"."c_birth_month", "customer4032"."c_birth_year", "customer4032"."c_birth_country", "customer4032"."c_login", "customer4032"."c_email_address", "customer4032"."c_last_review_date_sk" FROM (SELECT * FROM (SELECT "t101712"."ss_customer_sk", "t101712"."ss_addr_sk", "t101712"."ss_ticket_number", SUM("t101712"."extended_price" * "t101714"."f1") AS "extended_price", SUM("t101712"."list_price" * "t101714"."f1") AS "list_price", SUM("t101712"."extended_tax" * "t101714"."f1") AS "extended_tax" FROM (SELECT "t101707"."ss_customer_sk", "t101707"."ss_hdemo_sk", "t101707"."ss_addr_sk", "t101707"."ss_ticket_number", SUM("t101707"."extended_price" * "t101709"."f1") AS "extended_price", SUM("t101707"."list_price" * "t101709"."f1") AS "list_price", SUM("t101707"."extended_tax" * "t101709"."f1") AS "extended_tax" FROM (SELECT "t101702"."ss_customer_sk", "t101702"."ss_hdemo_sk", "t101702"."ss_addr_sk", "t101702"."ss_store_sk", "t101702"."ss_ticket_number", SUM("t101702"."extended_price" * "t101704"."f1") AS "extended_price", SUM("t101702"."list_price" * "t101704"."f1") AS "list_price", SUM("t101702"."extended_tax" * "t101704"."f1") AS "extended_tax" FROM (SELECT "ss_sold_date_sk", "ss_customer_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_store_sk", "ss_ticket_number", SUM("ss_ext_sales_price") AS "extended_price", SUM("ss_ext_list_price") AS "list_price", SUM("ss_ext_tax") AS "extended_tax" FROM "store_sales" GROUP BY "ss_sold_date_sk", "ss_customer_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_store_sk", "ss_ticket_number") AS "t101702", (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_dom" >= 1 AND "d_dom" <= 2 AND ("d_year" = 1998 OR "d_year" = 1998 + 1 OR "d_year" = 1998 + 2) GROUP BY "d_date_sk") AS "t101704" WHERE "t101702"."ss_sold_date_sk" = "t101704"."d_date_sk" GROUP BY "t101702"."ss_customer_sk", "t101702"."ss_hdemo_sk", "t101702"."ss_addr_sk", "t101702"."ss_store_sk", "t101702"."ss_ticket_number") AS "t101707", (SELECT "s_store_sk", COUNT(*) AS "f1" FROM "store" WHERE "s_city" IN ('Fairview', 'Midway') GROUP BY "s_store_sk") AS "t101709" WHERE "t101707"."ss_store_sk" = "t101709"."s_store_sk" GROUP BY "t101707"."ss_customer_sk", "t101707"."ss_hdemo_sk", "t101707"."ss_addr_sk", "t101707"."ss_ticket_number") AS "t101712", (SELECT "hd_demo_sk", COUNT(*) AS "f1" FROM "household_demographics" WHERE "hd_dep_count" = 3 OR "hd_vehicle_count" = 4 GROUP BY "hd_demo_sk") AS "t101714" WHERE "t101712"."ss_hdemo_sk" = "t101714"."hd_demo_sk" GROUP BY "t101712"."ss_customer_sk", "t101712"."ss_addr_sk", "t101712"."ss_ticket_number") AS "t101717", (SELECT "ca_address_sk", "ca_city", COUNT(*) AS "f2" FROM "customer_address" GROUP BY "ca_address_sk", "ca_city") AS "t101718" WHERE "t101717"."ss_addr_sk" = "t101718"."ca_address_sk") AS "t101719", "customer" AS "customer4032") AS "t101722" WHERE "t101722"."ss_customer_sk" = "t101722"."c_customer_sk") AS "t101723", "customer_address" AS "customer_address3887" WHERE "t101723"."c_current_addr_sk" = "customer_address3887"."ca_address_sk" AND "customer_address3887"."ca_city" <> "t101723"."bought_city" ORDER BY "t101723"."c_last_name", "t101723"."ss_ticket_number" FETCH NEXT 100 ROWS ONLY