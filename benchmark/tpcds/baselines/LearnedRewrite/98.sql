SELECT "t137247"."i_item_id", "t137247"."i_item_desc", "t137247"."i_category", "t137247"."i_class", "t137247"."i_current_price", "t137247"."itemrevenue", "t137247"."itemrevenue" * 100 / (SUM("t137247"."itemrevenue") OVER (PARTITION BY "t137247"."i_class" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS "revenueratio" FROM (SELECT "t137242"."i_item_id", "t137242"."i_item_desc", "t137242"."i_category", "t137242"."i_class", "t137242"."i_current_price", SUM("t137242"."itemrevenue" * "t137244"."f1") AS "itemrevenue" FROM (SELECT "t137238"."ss_sold_date_sk", "t137240"."i_item_id", "t137240"."i_item_desc", "t137240"."i_current_price", "t137240"."i_class", "t137240"."i_category", SUM("t137238"."itemrevenue" * "t137240"."f6") AS "itemrevenue" FROM (SELECT "ss_sold_date_sk", "ss_item_sk", SUM("ss_ext_sales_price") AS "itemrevenue" FROM "store_sales" GROUP BY "ss_sold_date_sk", "ss_item_sk") AS "t137238" INNER JOIN (SELECT "i_item_sk", "i_item_id", "i_item_desc", "i_current_price", "i_class", "i_category", COUNT(*) AS "f6" FROM "item" WHERE "i_category" IN ('Jewelry', 'Men', 'Sports') GROUP BY "i_item_sk", "i_item_id", "i_item_desc", "i_current_price", "i_class", "i_category") AS "t137240" ON "t137238"."ss_item_sk" = "t137240"."i_item_sk" GROUP BY "t137238"."ss_sold_date_sk", "t137240"."i_item_id", "t137240"."i_item_desc", "t137240"."i_current_price", "t137240"."i_class", "t137240"."i_category") AS "t137242" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_date" >= DATE '1999-02-05' AND "d_date" <= (DATE '1999-02-05' + INTERVAL '30' DAY) GROUP BY "d_date_sk") AS "t137244" ON "t137242"."ss_sold_date_sk" = "t137244"."d_date_sk" GROUP BY "t137242"."i_item_id", "t137242"."i_item_desc", "t137242"."i_current_price", "t137242"."i_class", "t137242"."i_category") AS "t137247" ORDER BY "t137247"."i_category", "t137247"."i_class", "t137247"."i_item_id", "t137247"."i_item_desc", "t137247"."itemrevenue" * 100 / (SUM("t137247"."itemrevenue") OVER (PARTITION BY "t137247"."i_class" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING))