SELECT "i_manufact_id", "sum_sales", "avg_quarterly_sales" FROM (SELECT "t70815"."i_manufact_id", "t70815"."sum_sales", (SUM("t70815"."sum_sales") OVER (PARTITION BY "t70815"."i_manufact_id" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) / (COUNT("t70815"."sum_sales") OVER (PARTITION BY "t70815"."i_manufact_id" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS "avg_quarterly_sales" FROM (SELECT "t70812"."i_manufact_id", "t70812"."d_qoy", SUM("t70812"."sum_sales" * "t70813"."f1") AS "sum_sales" FROM (SELECT "t70808"."i_manufact_id", "t70808"."ss_store_sk", "t70810"."d_qoy", SUM("t70808"."sum_sales" * "t70810"."f2") AS "sum_sales" FROM (SELECT "t70805"."i_manufact_id", "t70806"."ss_sold_date_sk", "t70806"."ss_store_sk", SUM("t70805"."f2" * "t70806"."sum_sales") AS "sum_sales" FROM (SELECT "i_item_sk", "i_manufact_id", COUNT(*) AS "f2" FROM "item" WHERE "i_category" IN ('Books', 'Children', 'Electronics') AND "i_class" IN ('personal', 'portable', 'reference', 'self-help') AND "i_brand" IN ('exportiunivamalg #9', 'scholaramalgamalg #14', 'scholaramalgamalg #7', 'scholaramalgamalg #9') OR "i_category" IN ('Men', 'Music', 'Women') AND "i_class" IN ('accessories', 'classical', 'fragrances', 'pants') AND "i_brand" IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1') GROUP BY "i_item_sk", "i_manufact_id") AS "t70805" INNER JOIN (SELECT "ss_sold_date_sk", "ss_item_sk", "ss_store_sk", SUM("ss_sales_price") AS "sum_sales" FROM "store_sales" GROUP BY "ss_sold_date_sk", "ss_item_sk", "ss_store_sk") AS "t70806" ON "t70805"."i_item_sk" = "t70806"."ss_item_sk" GROUP BY "t70805"."i_manufact_id", "t70806"."ss_sold_date_sk", "t70806"."ss_store_sk") AS "t70808" INNER JOIN (SELECT "d_date_sk", "d_qoy", COUNT(*) AS "f2" FROM "date_dim" WHERE "d_month_seq" = 1186 OR ("d_month_seq" = 1186 + 1 OR "d_month_seq" = 1186 + 2) OR ("d_month_seq" = 1186 + 3 OR ("d_month_seq" = 1186 + 4 OR "d_month_seq" = 1186 + 5)) OR ("d_month_seq" = 1186 + 6 OR ("d_month_seq" = 1186 + 7 OR "d_month_seq" = 1186 + 8) OR ("d_month_seq" = 1186 + 9 OR ("d_month_seq" = 1186 + 10 OR "d_month_seq" = 1186 + 11))) GROUP BY "d_date_sk", "d_qoy") AS "t70810" ON "t70808"."ss_sold_date_sk" = "t70810"."d_date_sk" GROUP BY "t70808"."i_manufact_id", "t70808"."ss_store_sk", "t70810"."d_qoy") AS "t70812" INNER JOIN (SELECT "s_store_sk", COUNT(*) AS "f1" FROM "store" GROUP BY "s_store_sk") AS "t70813" ON "t70812"."ss_store_sk" = "t70813"."s_store_sk" GROUP BY "t70812"."i_manufact_id", "t70812"."d_qoy") AS "t70815") AS "t70816" WHERE CASE WHEN "avg_quarterly_sales" > 0 THEN ABS("sum_sales" - "avg_quarterly_sales") / "avg_quarterly_sales" > 0.1 ELSE FALSE END ORDER BY "avg_quarterly_sales", "sum_sales", "i_manufact_id" FETCH NEXT 100 ROWS ONLY