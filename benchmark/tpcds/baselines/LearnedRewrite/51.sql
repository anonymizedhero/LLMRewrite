SELECT CASE WHEN "t68172"."item_sk" IS NOT NULL THEN "t68172"."item_sk" ELSE "t68176"."item_sk" END AS "item_sk", CASE WHEN "t68172"."d_date" IS NOT NULL THEN "t68172"."d_date" ELSE "t68176"."d_date" END AS "d_date", "t68172"."cume_sales" AS "web_sales", "t68176"."cume_sales" AS "store_sales", MAX("t68172"."cume_sales") OVER (PARTITION BY CASE WHEN "t68172"."item_sk" IS NOT NULL THEN "t68172"."item_sk" ELSE "t68176"."item_sk" END ORDER BY CASE WHEN "t68172"."d_date" IS NOT NULL THEN "t68172"."d_date" ELSE "t68176"."d_date" END ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "web_cumulative", MAX("t68176"."cume_sales") OVER (PARTITION BY CASE WHEN "t68172"."item_sk" IS NOT NULL THEN "t68172"."item_sk" ELSE "t68176"."item_sk" END ORDER BY CASE WHEN "t68172"."d_date" IS NOT NULL THEN "t68172"."d_date" ELSE "t68176"."d_date" END ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "store_cumulative" FROM (SELECT "web_sales2324"."ws_item_sk" AS "item_sk", "date_dim9484"."d_date", SUM(SUM("web_sales2324"."ws_sales_price")) OVER (PARTITION BY "web_sales2324"."ws_item_sk" ORDER BY "date_dim9484"."d_date" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "cume_sales" FROM "web_sales" AS "web_sales2324", "date_dim" AS "date_dim9484" WHERE "web_sales2324"."ws_sold_date_sk" = "date_dim9484"."d_date_sk" AND "date_dim9484"."d_month_seq" >= 1212 AND "date_dim9484"."d_month_seq" <= 1212 + 11 AND "web_sales2324"."ws_item_sk" IS NOT NULL GROUP BY "web_sales2324"."ws_item_sk", "date_dim9484"."d_date") AS "t68172" FULL JOIN (SELECT "store_sales6056"."ss_item_sk" AS "item_sk", "date_dim9485"."d_date", SUM(SUM("store_sales6056"."ss_sales_price")) OVER (PARTITION BY "store_sales6056"."ss_item_sk" ORDER BY "date_dim9485"."d_date" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "cume_sales" FROM "store_sales" AS "store_sales6056", "date_dim" AS "date_dim9485" WHERE "store_sales6056"."ss_sold_date_sk" = "date_dim9485"."d_date_sk" AND "date_dim9485"."d_month_seq" >= 1212 AND "date_dim9485"."d_month_seq" <= 1212 + 11 AND "store_sales6056"."ss_item_sk" IS NOT NULL GROUP BY "store_sales6056"."ss_item_sk", "date_dim9485"."d_date") AS "t68176" ON "t68172"."item_sk" = "t68176"."item_sk" AND "t68172"."d_date" = "t68176"."d_date" WHERE (MAX("t68172"."cume_sales") OVER (PARTITION BY CASE WHEN "t68172"."item_sk" IS NOT NULL THEN "t68172"."item_sk" ELSE "t68176"."item_sk" END ORDER BY CASE WHEN "t68172"."d_date" IS NOT NULL THEN "t68172"."d_date" ELSE "t68176"."d_date" END ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)) > (MAX("t68176"."cume_sales") OVER (PARTITION BY CASE WHEN "t68172"."item_sk" IS NOT NULL THEN "t68172"."item_sk" ELSE "t68176"."item_sk" END ORDER BY CASE WHEN "t68172"."d_date" IS NOT NULL THEN "t68172"."d_date" ELSE "t68176"."d_date" END ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)) ORDER BY CASE WHEN "t68172"."item_sk" IS NOT NULL THEN "t68172"."item_sk" ELSE "t68176"."item_sk" END, CASE WHEN "t68172"."d_date" IS NOT NULL THEN "t68172"."d_date" ELSE "t68176"."d_date" END FETCH NEXT 100 ROWS ONLY