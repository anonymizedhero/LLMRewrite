SELECT "customer4340"."c_customer_id", "customer4340"."c_salutation", "customer4340"."c_first_name", "customer4340"."c_last_name", "t114182"."ca_street_number", "t114182"."ca_street_name", "t114182"."ca_street_type", "t114182"."ca_suite_number", "t114182"."ca_city", "t114182"."ca_county", "t114182"."ca_state", "t114182"."ca_zip", "t114182"."ca_country", "t114182"."ca_gmt_offset", "t114182"."ca_location_type", "t114181"."ctr_total_return" FROM (SELECT "t114178"."cr_returning_customer_sk", "t114179"."ca_state", SUM("t114178"."ctr_total_return" * "t114179"."f2") AS "ctr_total_return" FROM (SELECT "t114174"."cr_returning_customer_sk", "t114174"."cr_returning_addr_sk", SUM("t114174"."ctr_total_return" * "t114176"."f1") AS "ctr_total_return" FROM (SELECT "cr_returned_date_sk", "cr_returning_customer_sk", "cr_returning_addr_sk", SUM("cr_return_amt_inc_tax") AS "ctr_total_return" FROM "catalog_returns" GROUP BY "cr_returned_date_sk", "cr_returning_customer_sk", "cr_returning_addr_sk") AS "t114174" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_year" = 2001 GROUP BY "d_date_sk") AS "t114176" ON "t114174"."cr_returned_date_sk" = "t114176"."d_date_sk" GROUP BY "t114174"."cr_returning_customer_sk", "t114174"."cr_returning_addr_sk") AS "t114178" INNER JOIN (SELECT "ca_address_sk", "ca_state", COUNT(*) AS "f2" FROM "customer_address" GROUP BY "ca_address_sk", "ca_state") AS "t114179" ON "t114178"."cr_returning_addr_sk" = "t114179"."ca_address_sk" GROUP BY "t114178"."cr_returning_customer_sk", "t114179"."ca_state") AS "t114181" CROSS JOIN (SELECT * FROM "customer_address" WHERE "ca_state" = 'TN') AS "t114182" INNER JOIN "customer" AS "customer4340" ON "t114182"."ca_address_sk" = "customer4340"."c_current_addr_sk" AND "t114181"."cr_returning_customer_sk" = "customer4340"."c_customer_sk" INNER JOIN (SELECT "t114190"."ca_state", AVG("t114190"."ctr_total_return") AS "f1" FROM (SELECT "t114187"."cr_returning_customer_sk", "t114188"."ca_state", SUM("t114187"."ctr_total_return" * "t114188"."f2") AS "ctr_total_return" FROM (SELECT "t114183"."cr_returning_customer_sk", "t114183"."cr_returning_addr_sk", SUM("t114183"."ctr_total_return" * "t114185"."f1") AS "ctr_total_return" FROM (SELECT "cr_returned_date_sk", "cr_returning_customer_sk", "cr_returning_addr_sk", SUM("cr_return_amt_inc_tax") AS "ctr_total_return" FROM "catalog_returns" GROUP BY "cr_returned_date_sk", "cr_returning_customer_sk", "cr_returning_addr_sk") AS "t114183" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "f1" FROM "date_dim" WHERE "d_year" = 2001 GROUP BY "d_date_sk") AS "t114185" ON "t114183"."cr_returned_date_sk" = "t114185"."d_date_sk" GROUP BY "t114183"."cr_returning_customer_sk", "t114183"."cr_returning_addr_sk") AS "t114187" INNER JOIN (SELECT "ca_address_sk", "ca_state", COUNT(*) AS "f2" FROM "customer_address" GROUP BY "ca_address_sk", "ca_state") AS "t114188" ON "t114187"."cr_returning_addr_sk" = "t114188"."ca_address_sk" GROUP BY "t114187"."cr_returning_customer_sk", "t114188"."ca_state") AS "t114190" GROUP BY "t114190"."ca_state") AS "t114191" ON "t114181"."ca_state" = "t114191"."ca_state" AND "t114181"."ctr_total_return" > "t114191"."f1" * 1.2 ORDER BY "customer4340"."c_customer_id", "customer4340"."c_salutation", "customer4340"."c_first_name", "customer4340"."c_last_name", "t114182"."ca_street_number", "t114182"."ca_street_name", "t114182"."ca_street_type", "t114182"."ca_suite_number", "t114182"."ca_city", "t114182"."ca_county", "t114182"."ca_state", "t114182"."ca_zip", "t114182"."ca_country", "t114182"."ca_gmt_offset", "t114182"."ca_location_type", "t114181"."ctr_total_return" FETCH NEXT 100 ROWS ONLY