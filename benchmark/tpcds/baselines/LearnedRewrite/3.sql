SELECT "t4322"."d_year", "t4324"."i_brand_id" AS "brand_id", "t4324"."i_brand" AS "brand", SUM("t4322"."sum_agg" * "t4324"."f3") AS "sum_agg" FROM (SELECT "t4319"."d_year", "t4320"."ss_item_sk", SUM("t4319"."f2" * "t4320"."sum_agg") AS "sum_agg" FROM (SELECT "d_date_sk", "d_year", COUNT(*) AS "f2" FROM "date_dim" WHERE "d_moy" = 11 GROUP BY "d_date_sk", "d_year") AS "t4319" INNER JOIN (SELECT "ss_sold_date_sk", "ss_item_sk", SUM("ss_sales_price") AS "sum_agg" FROM "store_sales" GROUP BY "ss_sold_date_sk", "ss_item_sk") AS "t4320" ON "t4319"."d_date_sk" = "t4320"."ss_sold_date_sk" GROUP BY "t4319"."d_year", "t4320"."ss_item_sk") AS "t4322" INNER JOIN (SELECT "i_item_sk", "i_brand_id", "i_brand", COUNT(*) AS "f3" FROM "item" WHERE "i_manufact_id" = 816 GROUP BY "i_item_sk", "i_brand_id", "i_brand") AS "t4324" ON "t4322"."ss_item_sk" = "t4324"."i_item_sk" GROUP BY "t4322"."d_year", "t4324"."i_brand_id", "t4324"."i_brand" ORDER BY "t4322"."d_year", SUM("t4322"."sum_agg" * "t4324"."f3") DESC, "t4324"."i_brand_id" FETCH NEXT 100 ROWS ONLY