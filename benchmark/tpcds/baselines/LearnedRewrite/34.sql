SELECT "customer2882"."c_last_name", "customer2882"."c_first_name", "customer2882"."c_salutation", "customer2882"."c_preferred_cust_flag", "t47015"."ss_ticket_number", "t47015"."cnt" FROM (SELECT "t47009"."ss_ticket_number", "t47009"."ss_customer_sk", COALESCE(SUM("t47009"."cnt" * "t47011"."cnt"), 0) AS "cnt" FROM (SELECT "t47005"."ss_customer_sk", "t47005"."ss_hdemo_sk", "t47005"."ss_ticket_number", COALESCE(SUM("t47005"."cnt" * "t47007"."cnt"), 0) AS "cnt" FROM (SELECT "t47001"."ss_customer_sk", "t47001"."ss_hdemo_sk", "t47001"."ss_store_sk", "t47001"."ss_ticket_number", COALESCE(SUM("t47001"."cnt" * "t47003"."cnt"), 0) AS "cnt" FROM (SELECT "ss_sold_date_sk", "ss_customer_sk", "ss_hdemo_sk", "ss_store_sk", "ss_ticket_number", COUNT(*) AS "cnt" FROM "store_sales" GROUP BY "ss_sold_date_sk", "ss_customer_sk", "ss_hdemo_sk", "ss_store_sk", "ss_ticket_number") AS "t47001" INNER JOIN (SELECT "d_date_sk", COUNT(*) AS "cnt" FROM "date_dim" WHERE ("d_dom" >= 1 AND "d_dom" <= 3 OR "d_dom" >= 25 AND "d_dom" <= 28) AND ("d_year" = 2000 OR "d_year" = 2000 + 1 OR "d_year" = 2000 + 2) GROUP BY "d_date_sk") AS "t47003" ON "t47001"."ss_sold_date_sk" = "t47003"."d_date_sk" GROUP BY "t47001"."ss_customer_sk", "t47001"."ss_hdemo_sk", "t47001"."ss_store_sk", "t47001"."ss_ticket_number") AS "t47005" INNER JOIN (SELECT "s_store_sk", COUNT(*) AS "cnt" FROM "store" WHERE "s_county" = 'Williamson County' GROUP BY "s_store_sk") AS "t47007" ON "t47005"."ss_store_sk" = "t47007"."s_store_sk" GROUP BY "t47005"."ss_customer_sk", "t47005"."ss_hdemo_sk", "t47005"."ss_ticket_number") AS "t47009" INNER JOIN (SELECT "hd_demo_sk", COUNT(*) AS "cnt" FROM "household_demographics" WHERE "hd_buy_potential" IN ('0-500', '1001-5000') AND "hd_vehicle_count" > 0 AND CASE WHEN "hd_vehicle_count" > 0 THEN "hd_dep_count" / "hd_vehicle_count" > 1.2 ELSE FALSE END GROUP BY "hd_demo_sk") AS "t47011" ON "t47009"."ss_hdemo_sk" = "t47011"."hd_demo_sk" GROUP BY "t47009"."ss_customer_sk", "t47009"."ss_ticket_number" HAVING COALESCE(SUM("t47009"."cnt" * "t47011"."cnt"), 0) >= 15 AND COALESCE(SUM("t47009"."cnt" * "t47011"."cnt"), 0) <= 20) AS "t47015" INNER JOIN "customer" AS "customer2882" ON "t47015"."ss_customer_sk" = "customer2882"."c_customer_sk" ORDER BY "customer2882"."c_last_name", "customer2882"."c_first_name", "customer2882"."c_salutation", "customer2882"."c_preferred_cust_flag" DESC, "t47015"."ss_ticket_number"