SELECT "t58437"."rnk", "t58437"."i_product_name" AS "best_performing", "item3187"."i_product_name" AS "worst_performing" FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT "t58416"."item_sk", RANK() OVER (ORDER BY "t58416"."rank_col") AS "rnk" FROM (SELECT "ss_item_sk" AS "item_sk", AVG("ss_net_profit") AS "rank_col" FROM "store_sales" WHERE "ss_store_sk" = 4 GROUP BY "ss_item_sk") AS "t58416", (SELECT SINGLE_VALUE("rank_col") AS "f0" FROM (SELECT AVG("ss_net_profit") AS "rank_col" FROM (SELECT "ss_store_sk", "ss_net_profit" FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS "t" ("ss_sold_date_sk", "ss_sold_time_sk", "ss_item_sk", "ss_customer_sk", "ss_cdemo_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_store_sk", "ss_promo_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_list_price", "ss_sales_price", "ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_ext_list_price", "ss_ext_tax", "ss_coupon_amt", "ss_net_paid", "ss_net_paid_inc_tax", "ss_net_profit") WHERE 1 = 0) AS "t58418" GROUP BY "ss_store_sk") AS "t58420") AS "t58421" WHERE "t58416"."rank_col" > 0.9 * "t58421"."f0") AS "t58423" WHERE "t58423"."rnk" < 11) AS "t58424", (SELECT * FROM (SELECT "t58427"."item_sk", RANK() OVER (ORDER BY "t58427"."rank_col" DESC) AS "rnk" FROM (SELECT "ss_item_sk" AS "item_sk", AVG("ss_net_profit") AS "rank_col" FROM "store_sales" WHERE "ss_store_sk" = 4 GROUP BY "ss_item_sk") AS "t58427", (SELECT SINGLE_VALUE("rank_col") AS "f0" FROM (SELECT AVG("ss_net_profit") AS "rank_col" FROM (SELECT "ss_store_sk", "ss_net_profit" FROM (VALUES (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) AS "t" ("ss_sold_date_sk", "ss_sold_time_sk", "ss_item_sk", "ss_customer_sk", "ss_cdemo_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_store_sk", "ss_promo_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_list_price", "ss_sales_price", "ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_ext_list_price", "ss_ext_tax", "ss_coupon_amt", "ss_net_paid", "ss_net_paid_inc_tax", "ss_net_profit") WHERE 1 = 0) AS "t58429" GROUP BY "ss_store_sk") AS "t58431") AS "t58432" WHERE "t58427"."rank_col" > 0.9 * "t58432"."f0") AS "t58434" WHERE "t58434"."rnk" < 11) AS "t58435" WHERE "t58424"."rnk" = "t58435"."rnk") AS "t58436", "item" AS "item3186" WHERE "item3186"."i_item_sk" = "t58436"."item_sk") AS "t58437", "item" AS "item3187" WHERE "item3187"."i_item_sk" = "t58437"."item_sk0" ORDER BY "t58437"."rnk" FETCH NEXT 100 ROWS ONLY