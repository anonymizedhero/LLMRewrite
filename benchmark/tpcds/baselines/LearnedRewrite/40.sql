SELECT "warehouse142"."w_state", "t53538"."i_item_id", SUM(CASE WHEN "t53539"."d_date" < DATE '2001-05-02' THEN "catalog_sales1933"."cs_sales_price" - CASE WHEN "catalog_returns142"."cr_refunded_cash" IS NOT NULL THEN CAST("catalog_returns142"."cr_refunded_cash" AS DECIMAL(19, 0)) ELSE 0 END ELSE 0 END) AS "sales_before", SUM(CASE WHEN "t53539"."d_date" >= DATE '2001-05-02' THEN "catalog_sales1933"."cs_sales_price" - CASE WHEN "catalog_returns142"."cr_refunded_cash" IS NOT NULL THEN CAST("catalog_returns142"."cr_refunded_cash" AS DECIMAL(19, 0)) ELSE 0 END ELSE 0 END) AS "sales_after" FROM "catalog_sales" AS "catalog_sales1933" LEFT JOIN "catalog_returns" AS "catalog_returns142" ON "catalog_sales1933"."cs_order_number" = "catalog_returns142"."cr_order_number" AND "catalog_sales1933"."cs_item_sk" = "catalog_returns142"."cr_item_sk" INNER JOIN "warehouse" AS "warehouse142" ON "catalog_sales1933"."cs_warehouse_sk" = "warehouse142"."w_warehouse_sk" INNER JOIN (SELECT * FROM "item" WHERE "i_current_price" >= 0.99 AND "i_current_price" <= 1.49) AS "t53538" ON "catalog_sales1933"."cs_item_sk" = "t53538"."i_item_sk" INNER JOIN (SELECT * FROM "date_dim" WHERE "d_date" >= (DATE '2001-05-02' - INTERVAL '30' DAY) AND "d_date" <= (DATE '2001-05-02' + INTERVAL '30' DAY)) AS "t53539" ON "catalog_sales1933"."cs_sold_date_sk" = "t53539"."d_date_sk" GROUP BY "warehouse142"."w_state", "t53538"."i_item_id" ORDER BY "warehouse142"."w_state", "t53538"."i_item_id" FETCH NEXT 100 ROWS ONLY